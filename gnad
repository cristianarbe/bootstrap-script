#!/bin/bash

# Load all modules
for file in modules/*; do
    # shellcheck disable=SC1090
    source "$file"
done

main(){
    set -e
    
    if [[ $EUID -ne 0 ]]; then
      echo "This script must be run as root"
      exit 1
    fi
    
    if [ "$1" == "install" ]; then
        if [ "$2" == "" ]; then
            echo "Nothing specified."
        else
            # shellcheck disable=SC1090
            source "$2" "$2"
            
            ask "Dot files install: this will install the dotfiles. This will \
override your dot files, do you want to proceed? [y/N]: " dot_files
            
            ask "This installs the packages, do you want to proceed? [y/N]: " install_apt
            
            ask "This installs the packages that are not in the default repos, do \
you want to proceed? [y/N]: " extra_packages

            ask "This install the themes, do you want to proceed? [y/N]: " theming
            
            ask "Installation finished, do you want to reboot? [y/N]: " reboot
        fi
        elif [ "$1" == "" ]; then
        echo "usage: gnad <command> [<args>]"
    else
        echo "gnad: '$2' is not a gnad command. See 'gnad --help'."
    fi
}

main "$@"